{"ast":null,"code":"import _classCallCheck from\"/Users/faisal/Code/FN/FE-NC-news/fe-nc-news/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/faisal/Code/FN/FE-NC-news/fe-nc-news/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/faisal/Code/FN/FE-NC-news/fe-nc-news/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/faisal/Code/FN/FE-NC-news/fe-nc-news/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/faisal/Code/FN/FE-NC-news/fe-nc-news/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import makeApiRequests from\"../utils/api\";import deleteCommentReq from\"../utils/deleteCommentReq\";import Vote from\"./Vote\";import Loading from\"./Loading\";import ErrDisplay from\"./ErrDisplay\";import NoticeMsgDisplay from\"./NoticeMsgDisplay\";var ArticleComments=/*#__PURE__*/function(_Component){_inherits(ArticleComments,_Component);function ArticleComments(){var _getPrototypeOf2;var _this;_classCallCheck(this,ArticleComments);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(ArticleComments)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={comments:[],sortBy:\"created_at\",loggedInUser:\"butter_bridge\",loading:true,err:false,err_msg:\"\",deletingComment:false,commentDeleted:false};_this.handleSortByByChange=function(_ref){var value=_ref.target.value;_this.setState({sortBy:value});};_this.handleDeleteComment=function(comment_id){_this.setState({commentDeleted:false,deletingComment:true});deleteCommentReq(\"comments/\".concat(comment_id)).then(function(){_this.setState({commentDeleted:true,deletingComment:false});}).catch(function(){_this.setState({loading:false,err:true,err_msg:\"The comment you trying to delete is no longer exist üôÖ‚Äç‚ôÄÔ∏è\"});});};return _this;}_createClass(ArticleComments,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var article_id=this.props.article_id;makeApiRequests(\"articles/\".concat(article_id,\"/comments\")).then(function(comments){_this2.setState({comments:comments,loading:false});});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){var _this3=this;var article_id=this.props.article_id;makeApiRequests(\"articles/\".concat(article_id,\"/comments?sort_by=\").concat(this.state.sortBy)).then(function(comments){_this3.setState({comments:comments});});}},{key:\"render\",value:function render(){var _this4=this;var comments=this.state.comments.comments;if(comments){if(this.state.err)return React.createElement(ErrDisplay,{err_msg:this.state.err_msg});return React.createElement(React.Fragment,null,this.state.commentDeleted&&React.createElement(NoticeMsgDisplay,{msg:\"The comment has been deleted!\"}),React.createElement(\"form\",null,React.createElement(\"label\",null,\"Sort comments by:\",React.createElement(\"select\",{value:this.state.value,onChange:this.handleSortByByChange},React.createElement(\"option\",{value:\"created_at\"},\"Date Created\"),React.createElement(\"option\",{value:\"username\"},\"Author\"),React.createElement(\"option\",{value:\"votes\"},\" Comment Votes\")))),comments.map(function(comment){return React.createElement(React.Fragment,null,React.createElement(\"hr\",null),React.createElement(\"br\",null),React.createElement(\"p\",null,\"Body: \",comment.body),!_this4.state.deletingComment&&_this4.state.loggedInUser===comment.username&&React.createElement(\"button\",{onClick:function onClick(event){return _this4.handleDeleteComment(comment.comment_id);}},\" \",\"Delete Comment\",\" \"),React.createElement(\"p\",null,\"Username: \",comment.username),React.createElement(\"p\",null,\"Created at: \",comment.created_at),React.createElement(\"br\",null),React.createElement(Vote,{id:comment.comment_id,currentVote:comment.votes,path:\"comments\"}));}));}else return React.createElement(Loading,{msg:\"Cool comments are on their way!\"});}}]);return ArticleComments;}(Component);export default ArticleComments;","map":{"version":3,"sources":["/Users/faisal/Code/FN/FE-NC-news/fe-nc-news/src/components/ArticleComments.jsx"],"names":["React","Component","makeApiRequests","deleteCommentReq","Vote","Loading","ErrDisplay","NoticeMsgDisplay","ArticleComments","state","comments","sortBy","loggedInUser","loading","err","err_msg","deletingComment","commentDeleted","handleSortByByChange","value","target","setState","handleDeleteComment","comment_id","then","catch","article_id","props","map","comment","body","username","event","created_at","votes"],"mappings":"ooBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,eAAP,KAA4B,cAA5B,CACA,MAAOC,CAAAA,gBAAP,KAA6B,2BAA7B,CACA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,OAAP,KAAoB,WAApB,CACA,MAAOC,CAAAA,UAAP,KAAuB,cAAvB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,oBAA7B,C,GAEMC,CAAAA,e,maACJC,K,CAAQ,CACNC,QAAQ,CAAE,EADJ,CAENC,MAAM,CAAE,YAFF,CAGNC,YAAY,CAAE,eAHR,CAINC,OAAO,CAAE,IAJH,CAKNC,GAAG,CAAE,KALC,CAMNC,OAAO,CAAE,EANH,CAONC,eAAe,CAAE,KAPX,CAQNC,cAAc,CAAE,KARV,C,OA2BRC,oB,CAAuB,cAA2B,IAAdC,CAAAA,KAAc,MAAxBC,MAAwB,CAAdD,KAAc,CAChD,MAAKE,QAAL,CAAc,CAAEV,MAAM,CAAEQ,KAAV,CAAd,EACD,C,OAEDG,mB,CAAsB,SAAAC,UAAU,CAAI,CAClC,MAAKF,QAAL,CAAc,CAAEJ,cAAc,CAAE,KAAlB,CAAyBD,eAAe,CAAE,IAA1C,CAAd,EACAb,gBAAgB,oBAAaoB,UAAb,EAAhB,CACGC,IADH,CACQ,UAAM,CACV,MAAKH,QAAL,CAAc,CAAEJ,cAAc,CAAE,IAAlB,CAAwBD,eAAe,CAAE,KAAzC,CAAd,EACD,CAHH,EAIGS,KAJH,CAIS,UAAM,CACX,MAAKJ,QAAL,CAAc,CACZR,OAAO,CAAE,KADG,CAEZC,GAAG,CAAE,IAFO,CAGZC,OAAO,CAAE,2DAHG,CAAd,EAKD,CAVH,EAWD,C,wGAjCmB,oBACVW,CAAAA,UADU,CACK,KAAKC,KADV,CACVD,UADU,CAElBxB,eAAe,oBAAawB,UAAb,cAAf,CAAmDF,IAAnD,CAAwD,SAAAd,QAAQ,CAAI,CAClE,MAAI,CAACW,QAAL,CAAc,CAAEX,QAAQ,CAARA,QAAF,CAAYG,OAAO,CAAE,KAArB,CAAd,EACD,CAFD,EAGD,C,+DAEoB,oBACXa,CAAAA,UADW,CACI,KAAKC,KADT,CACXD,UADW,CAEnBxB,eAAe,oBACDwB,UADC,8BAC8B,KAAKjB,KAAL,CAAWE,MADzC,EAAf,CAEEa,IAFF,CAEO,SAAAd,QAAQ,CAAI,CACjB,MAAI,CAACW,QAAL,CAAc,CAAEX,QAAQ,CAARA,QAAF,CAAd,EACD,CAJD,EAKD,C,uCAqBQ,oBAEOA,CAAAA,QAFP,CAGH,KAAKD,KAHF,CAELC,QAFK,CAEOA,QAFP,CAKP,GAAIA,QAAJ,CAAc,CACZ,GAAI,KAAKD,KAAL,CAAWK,GAAf,CAAoB,MAAO,qBAAC,UAAD,EAAY,OAAO,CAAE,KAAKL,KAAL,CAAWM,OAAhC,EAAP,CACpB,MACE,yCACG,KAAKN,KAAL,CAAWQ,cAAX,EACC,oBAAC,gBAAD,EAAkB,GAAG,CAAE,+BAAvB,EAFJ,CAIE,gCACE,qDAEE,8BACE,KAAK,CAAE,KAAKR,KAAL,CAAWU,KADpB,CAEE,QAAQ,CAAE,KAAKD,oBAFjB,EAIE,8BAAQ,KAAK,CAAC,YAAd,iBAJF,CAKE,8BAAQ,KAAK,CAAC,UAAd,WALF,CAME,8BAAQ,KAAK,CAAC,OAAd,mBANF,CAFF,CADF,CAJF,CAiBGR,QAAQ,CAACkB,GAAT,CAAa,SAAAC,OAAO,CAAI,CACvB,MACE,yCACE,8BADF,CAEE,8BAFF,CAGE,sCAAUA,OAAO,CAACC,IAAlB,CAHF,CAIG,CAAC,MAAI,CAACrB,KAAL,CAAWO,eAAZ,EACC,MAAI,CAACP,KAAL,CAAWG,YAAX,GAA4BiB,OAAO,CAACE,QADrC,EAEG,8BACE,OAAO,CAAE,iBAAAC,KAAK,QACZ,CAAA,MAAI,CAACV,mBAAL,CAAyBO,OAAO,CAACN,UAAjC,CADY,EADhB,EAKG,GALH,kBAMiB,GANjB,CANN,CAeE,0CAAcM,OAAO,CAACE,QAAtB,CAfF,CAgBE,4CAAgBF,OAAO,CAACI,UAAxB,CAhBF,CAiBE,8BAjBF,CAkBE,oBAAC,IAAD,EACE,EAAE,CAAEJ,OAAO,CAACN,UADd,CAEE,WAAW,CAAEM,OAAO,CAACK,KAFvB,CAGE,IAAI,CAAE,UAHR,EAlBF,CADF,CA0BD,CA3BA,CAjBH,CADF,CAgDD,CAlDD,IAkDO,OAAO,qBAAC,OAAD,EAAS,GAAG,CAAE,iCAAd,EAAP,CACR,C,6BAvG2BjC,S,EA0G9B,cAAeO,CAAAA,eAAf","sourcesContent":["import React, { Component } from \"react\";\nimport makeApiRequests from \"../utils/api\";\nimport deleteCommentReq from \"../utils/deleteCommentReq\";\nimport Vote from \"./Vote\";\nimport Loading from \"./Loading\";\nimport ErrDisplay from \"./ErrDisplay\";\nimport NoticeMsgDisplay from \"./NoticeMsgDisplay\";\n\nclass ArticleComments extends Component {\n  state = {\n    comments: [],\n    sortBy: \"created_at\",\n    loggedInUser: \"butter_bridge\",\n    loading: true,\n    err: false,\n    err_msg: \"\",\n    deletingComment: false,\n    commentDeleted: false\n  };\n\n  componentDidMount() {\n    const { article_id } = this.props;\n    makeApiRequests(`articles/${article_id}/comments`).then(comments => {\n      this.setState({ comments, loading: false });\n    });\n  }\n\n  componentDidUpdate() {\n    const { article_id } = this.props;\n    makeApiRequests(\n      `articles/${article_id}/comments?sort_by=${this.state.sortBy}`\n    ).then(comments => {\n      this.setState({ comments });\n    });\n  }\n\n  handleSortByByChange = ({ target: { value } }) => {\n    this.setState({ sortBy: value });\n  };\n\n  handleDeleteComment = comment_id => {\n    this.setState({ commentDeleted: false, deletingComment: true });\n    deleteCommentReq(`comments/${comment_id}`)\n      .then(() => {\n        this.setState({ commentDeleted: true, deletingComment: false });\n      })\n      .catch(() => {\n        this.setState({\n          loading: false,\n          err: true,\n          err_msg: \"The comment you trying to delete is no longer exist üôÖ‚Äç‚ôÄÔ∏è\"\n        });\n      });\n  };\n\n  render() {\n    const {\n      comments: { comments }\n    } = this.state;\n\n    if (comments) {\n      if (this.state.err) return <ErrDisplay err_msg={this.state.err_msg} />;\n      return (\n        <>\n          {this.state.commentDeleted && (\n            <NoticeMsgDisplay msg={\"The comment has been deleted!\"} />\n          )}\n          <form>\n            <label>\n              Sort comments by:\n              <select\n                value={this.state.value}\n                onChange={this.handleSortByByChange}\n              >\n                <option value=\"created_at\">Date Created</option>\n                <option value=\"username\">Author</option>\n                <option value=\"votes\"> Comment Votes</option>\n              </select>\n            </label>\n          </form>\n          {comments.map(comment => {\n            return (\n              <>\n                <hr />\n                <br />\n                <p>Body: {comment.body}</p>\n                {!this.state.deletingComment &&\n                  this.state.loggedInUser === comment.username && (\n                    <button\n                      onClick={event =>\n                        this.handleDeleteComment(comment.comment_id)\n                      }\n                    >\n                      {\" \"}\n                      Delete Comment{\" \"}\n                    </button>\n                  )}\n                <p>Username: {comment.username}</p>\n                <p>Created at: {comment.created_at}</p>\n                <br />\n                <Vote\n                  id={comment.comment_id}\n                  currentVote={comment.votes}\n                  path={\"comments\"}\n                />\n              </>\n            );\n          })}\n        </>\n      );\n    } else return <Loading msg={\"Cool comments are on their way!\"} />;\n  }\n}\n\nexport default ArticleComments;\n"]},"metadata":{},"sourceType":"module"}